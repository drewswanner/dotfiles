!function(n,t){for(var r in t)n[r]=t[r]}(exports,function(n){var t={};function r(e){if(t[e])return t[e].exports;var u=t[e]={i:e,l:!1,exports:{}};return n[e].call(u.exports,u,u.exports,r),u.l=!0,u.exports}return r.m=n,r.c=t,r.d=function(n,t,e){r.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:e})},r.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r.t=function(n,t){if(1&t&&(n=r(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var u in n)r.d(e,u,function(t){return n[t]}.bind(null,u));return e},r.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(t,"a",t),t},r.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},r.p="",r(r.s=443)}({1:function(n,t){n.exports=require("fs")},10:function(n,t){n.exports=require("http")},100:function(n,t,r){"use strict";n.exports={map:r(101),asyncMap:r(102),filter:r(38),filterNot:r(103),through:r(104),take:r(105),unique:r(59),nonUnique:r(106),flatten:r(107)}},101:function(n,t,r){"use strict";function e(n){return n}var u=r(19);n.exports=function(n){return n?(n=u(n),function(t){return function(r,e){t(r,(function(r,u){try{u=r?null:n(u)}catch(n){return t(n,(function(){return e(n)}))}e(r,u)}))}}):e}},102:function(n,t,r){"use strict";function e(n){return n}var u=r(19);n.exports=function(n){if(!n)return e;n=u(n);var t,r,o=!1;return function(e){return function u(i,c){if(r)return c(r);i?(r=i,e(i,o?function(n){o?t=c:c(i)}:function(n){c(i)})):e(null,(function(e,i){e?c(e):r?c(r):(o=!0,n(i,(function(n,e){o=!1,r?(c(r),t&&t(r)):n?u(n,c):c(null,e)})))}))}}}},103:function(n,t,r){"use strict";var e=r(58),u=r(38);n.exports=function(n){return n=e(n),u((function(t){return!n(t)}))}},104:function(n,t,r){"use strict";n.exports=function(n,t){var r=!1;function e(n){!r&&t&&(r=!0,t(!0===n?null:n))}return function(t){return function(r,u){return r&&e(r),t(r,(function(t,r){t?e(t):n&&n(r),u(t,r)}))}}}},105:function(n,t,r){"use strict";n.exports=function(n,t){var r=(t=t||{}).last||!1,e=!1;if("number"==typeof n){r=!0;var u=n;n=function(){return--u}}return function(t){function u(n){t(!0,(function(t){r=!1,n(t||!0)}))}return function(o,i){e&&!o?r?u(i):i(e):(e=o)?t(e,i):t(null,(function(t,o){(e=e||t)?i(e):n(o)?i(null,o):(e=!0,r?i(null,o):u(i))}))}}}},106:function(n,t,r){"use strict";var e=r(59);n.exports=function(n){return e(n,!0)}},107:function(n,t,r){"use strict";var e=r(36),u=r(57);n.exports=function(){return function(n){var t;return function(r,o){function i(){t(null,(function(t,r){!0===t?c():t?n(!0,(function(n){o(t)})):o(null,r)}))}function c(){t=null,n(null,(function(n,r){if(n)return o(n);Array.isArray(r)||r&&"object"==typeof r?r=e(r):"function"!=typeof r&&(r=u(r)),t=r,i()}))}r?t?t(r,(function(t){n(t||r,o)})):n(r,o):t?i():c()}}}},108:function(n,t,r){"use strict";var e=r(109),u=(r(20),r(113)),o=r(140),i=r(141),c=r(17).EventEmitter;function s(n,t,r,s,f,l,a){var p;"function"==typeof n&&(p=n,n={}),t=t||{},n=n||{};var h,d=new c;l||(l=e);var v={_emit:function(n,t){return d&&d._emit(n,t),v},id:s},y=u(i(r,t,f).bind(v),l,(function(n){if(!d.closed&&(d.closed=!0,d.emit("closed"),h)){var t=h;h=null,t(n)}}));if(o(d,n,(function(n,t,r,e){if(y.closed)throw new Error("stream is closed");return y.remoteCall(n,t,r,e)}),p),d._emit=d.emit,a){Object.__defineGetter__.call(d,"id",(function(){return v.id})),Object.__defineSetter__.call(d,"id",(function(n){v.id=n}));var m=!0;d.createStream=function(n){if(h=n,m)return m=!1,y;throw new Error("one stream per rpc")}}else d.stream=y;return d.closed=!1,d.close=function(n,t){return y.close(n,t),this},d}n.exports=function(n,t,r){return arguments.length>3?s.apply(this,arguments):function(e,u,o){return s(n,t,e,o,u,r,!0)}}},109:function(n,t,r){var e=r(110),u=r(111),o=0,i=1,c=2,s="GOODBYE",f=Buffer.isBuffer;function l(n){return"string"==typeof n}function a(n){var t=new Buffer(9),r=0,e=void 0!==n.value?n.value:n.end;return l(n)&&n===s?(t.fill(0),[t,null]):(l(e)?(r=i,e=new Buffer(e)):f(e)?r=o:(r=c,e=new Buffer(JSON.stringify(e))),r=n.stream<<3|n.end<<2|r,t[0]=r,t.writeUInt32BE(e.length,1),t.writeInt32BE(n.req||0,5),[t,e])}function p(n){if(9!=n.length)throw new Error("expected header to be 9 bytes long");var t=n[0],r=n.readUInt32BE(1);return{req:n.readInt32BE(5),stream:!!(8&t),end:!!(4&t),value:null,length:r,type:3&t}}function h(n,t){if(n.length!==t.length)throw new Error("incorrect length, expected:"+t.length+" found:"+n.length);if(o===t.type)t.value=n;else if(i===t.type)t.value=n.toString();else{if(c!==t.type)throw new Error("unknown message type");t.value=JSON.parse(n.toString())}return t}function d(){return e((function(n){var t=a(n);this.queue(t[0]),null!==t[1]&&this.queue(t[1])}))}function v(){var n=u(),t=!1;return function(r){return n(r),function(r,e){return t?e(!0):r?n.abort(r,e):void n.read(9,(function(r,u){if(r)return e(r);var o=p(u);if(0===o.length)return t=!0,e(null,s);n.read(o.length,(function(n,t){if(n)return e(n);try{h(t,o)}catch(n){return e(n)}e(null,o)}))}))}}}(t=n.exports=function(n){return{source:d()(n.source),sink:function(t){return n.sink(v()(t))}}}).encodePair=a,t.decodeHead=p,t.decodeBody=h,t.encode=d,t.decode=v},110:function(n,t,r){var e=r(61);n.exports=function(n,t){return function(r){var u,o,i=[];function c(n){i.push(n)}n=n||function(n){this.queue(n)},t=t||function(){this.queue(null)};var s,f={emit:function(n,t){"data"==n&&c(t),"end"==n&&(u=!0,c(null)),"error"==n&&(o=t)},queue:c};return function(c,l){if(u=u||c,c)return r(c,(function(){if(s){var n=s;s=null,n(c)}l(c)}));s=l,e((function e(c){if(s)if(l=s,o)s=null,l(o);else if(i.length){var a=i.shift();s=null,l(null===a,a)}else r(u,(function(i,a){if(i&&!0!==i)return o=i,c();if(u=u||i)t.call(f);else if(null!==a&&(n.call(f,a),o||u))return r(o||u,(function(){s=null,l(o||u)}));c(e)}))}))}}}},111:function(n,t,r){"use strict";var e=r(112);function u(n){return"function"==typeof n}function o(n,t){return t?function(r,e){var u=setTimeout((function(){n(new Error("pull-reader: read exceeded timeout"),e)}),t);n(r,(function(n,t){clearTimeout(u),e(n,t)}))}:n}n.exports=function(n){var t,r,i,c,s,f=[],l=!1,a=e();function p(){for(;f.length;)if(null==f[0].length&&a.has(1))f.shift().cb(null,a.get());else if(a.has(f[0].length)){var n=f.shift();n.cb(null,a.get(n.length))}else if(1==i&&f[0].length&&a.length<f[0].length){var t="stream ended with:"+a.length+" but wanted:"+f[0].length;f.shift().cb(new Error(t))}else{if(!i)return!!f.length;f.shift().cb(i)}return f.length||!a.has(1)||s}function h(){p()&&!l&&(!t||l||c||(l=!0,r(null,(function(n,t){if(l=!1,n)return i=n,p();a.add(t),h()}))))}function d(e){if(s){for(;f.length;)f.shift().cb(s);return cb&&cb(s)}r=o(e,n),t=e,h()}return d.abort=function(n,r){s=n||!0,t?(l=!0,t(s,(function(){for(;f.length;)f.shift().cb(s);r&&r(s)}))):r()},d.read=function(r,e,i){if(u(e)&&(i=e,e=n),!u(i))return c=!0,function(n,r){if(l||a.has(1)){if(n)return t(n,r);f.push({length:null,cb:r}),h()}else o(t,e)(n,(function(n,t){r(n,t)}))};var s;f.push({length:(s=r,Number.isFinite(s)?r:null),cb:i}),h()},d}},112:function(n,t){n.exports=function(){var n=[],t=0;return{length:t,data:this,add:function(r){if(!Buffer.isBuffer(r))throw new Error("data must be a buffer, was: "+JSON.stringify(r));return this.length=t+=r.length,n.push(r),this},has:function(n){return null==n?t>0:t>=n},get:function(r){var e;if(null==r||r===t){t=0;var u=n;return n=[],1==u.length?u[0]:Buffer.concat(u)}if(n.length>1&&r<=(e=n[0].length)){var o=n[0].slice(0,r);return r===e?n.shift():n[0]=n[0].slice(r,e),t-=r,o}if(r<t){for(var i=[],c=0;c+n[0].length<r;){var s=n.shift();c+=s.length,i.push(s)}return c<r&&(i.push(n[0].slice(0,r-c)),n[0]=n[0].slice(r-c,n[0].length),this.length=t-=r),Buffer.concat(i)}throw new Error("could not get "+r+" bytes")}}}},113:function(n,t,r){"use strict";var e=r(114),u=(r(28),r(115)),o=r(116),i=r(20),c=r(66);function s(n){return function(n){return"sync"===n}(n)||function(n){return"async"===n}(n)}function f(n){return function(n){return"source"===n}(n)||function(n){return"sink"===n}(n)||function(n){return"duplex"===n}(n)}n.exports=function(n,t,r){var l=e({message:function(n){},request:function(t,r){if(!Array.isArray(t.args))return r(new Error("invalid request, args should be array, was:"+JSON.stringify(t)));var e=t.name,u=t.args,o=!1,i=!1;u.push((function(n,t){i=!0,o=!0,r(n,t)}));try{n("async",e,u)}catch(n){if(o||i)throw c(n,"no callback provided to muxrpc async funtion");return r(n)}},stream:function(t){t.read=function(r,e){var o,c,s=r.name,l=r.type;if(t.read=null,!f(l))return t.write(null,new Error("unsupported stream type:"+l));if(e)return t.write(null,e);try{c=n(l,s,r.args)}catch(n){o=n}var a=u[{source:"sink",sink:"source"}[l]||"duplex"](t);return i.pipeToStream(l,a,o?i.errorAsStream(l,o):c)}},close:function(n){if(l=null,a.ended=!0,!a.closed&&(a.closed=!0,r)){var t=r;r=null,t(n)}}}),a=o(u(l,(function(n){})));return(a=t?t(a):a).remoteCall=function(n,t,r,e){if("emit"===t)return l.message(r);if(!s(n)&&!f(n))throw new Error("unsupported type:"+JSON.stringify(n));if(s(n))return l.request({name:t,args:r},e);var o=l.stream(),i=u[n](o,e);return o.write({name:t,args:r,type:n}),i},a.isOpen=function(){return!l.ended},a.close=function(n,t){return"function"==typeof n&&(t=n,n=!1),l?n?(l.destroy(n),t&&t()):(l.close((function(n){if(t)t(n);else if(n)throw c(n,"no callback provided for muxrpc close")})),this):t&&t()},a.closed=!1,a}},114:function(n,t){function r(n){return n?!0===n||{message:n.message,name:n.name,stack:n.stack}:n}function e(n){this.ended=!1,this.opts=n,this._req_counter=1,this._requests={},this._instreams={},this._outstreams={},this._closecbs=[],this._closing=!1,this._closed=!1,n.close&&this._closecbs.push(n.close)}function u(n){console.error("packet-stream asked to read after closed",n)}function o(n,t,r){this.id=n,this.read=null,this.writeEnd=null,this.readEnd=null,this._ps=t,this._remove=r,this._seq_counter=1}n.exports=function(n){return new e(n)},e.prototype.message=function(n){this.read({req:0,stream:!1,end:!1,value:n})},e.prototype.request=function(n,t){if(this._closing)return t(new Error("parent stream is closing"));var r=this._req_counter++,e=this;this._requests[r]=function(n,u){delete e._requests[r],t(n,u),e._maybedone()},this.read({req:r,stream:!1,end:!1,value:n})},e.prototype.stream=function(){if(this._closing)throw new Error("parent stream is closing");var n=this._req_counter++,t=this;return this._outstreams[n]=new o(n,this,(function(){delete t._outstreams[n]})),this._outstreams[n]},e.prototype.close=function(n){if(!n)throw new Error("packet-stream.close *must* have callback");if(this._closed)return n();this._closecbs.push(n),this._closing=!0,this._maybedone()},e.prototype.destroy=function(n){n=n||r(n),this.ended=n,this._closing=!0;var t=!0===n?new Error("unexpected end of parent stream"):n,e=0;for(var u in this._requests)e++,this._requests[u](t);for(var u in this._instreams)e++,this._instreams[u].writeEnd=!0,this._instreams[u].destroy(t);for(var u in this._outstreams)e++,this._outstreams[u].writeEnd=!0,this._outstreams[u].destroy(t);0===e&&!0===n&&(t=null),this._maybedone(t)},e.prototype._maybedone=function(n){!this._closed&&this._closing&&0===Object.keys(this._requests).length&&0===Object.keys(this._instreams).length&&0===Object.keys(this._outstreams).length&&(this._closed=!0,this._closecbs.forEach((function(t){t(n)})),this.read(null,n||!0),this.opts=null,this._closecbs.length=0,this.read=u)},e.prototype.read=function(n){console.error("please overwrite read method to do IO",n)},e.prototype.write=function(n,t){this.ended||(t?this.destroy(t):n.req&&!n.stream?this._onrequest(n):n.req&&n.stream?this._onstream(n):this._onmessage(n))},e.prototype._onmessage=function(n){this.opts&&"function"==typeof this.opts.message&&this.opts.message(n.value)},e.prototype._onrequest=function(n){var t=-1*n.req;if(n.req<0)"function"==typeof this._requests[t]&&this._requests[t](n.end?n.value:null,n.end?null:n.value);else if(this.opts&&"function"==typeof this.opts.request){var e=!1,u=this;this.opts.request(n.value,(function(n,o){if(e)throw new Error("cb called twice from local api");e=!0,n?u.read({value:r(n),end:!0,req:t}):u.read({value:o,end:!1,req:t}),u._maybedone()}))}else{if(this.ended){var o=!0===this.ended?new Error("unexpected end of parent stream"):this.ended;this.read({value:r(o),end:!0,stream:!1,req:t})}else this.read({value:{message:"Unable to handle requests",name:"NO_REQUEST_HANDLER",stack:null},end:!0,stream:!1,req:t});this._maybedone()}},e.prototype._onstream=function(n){if(n.req<0){var t=-1*n.req,r=this._outstreams[t];if(!r)return console.error("no stream for incoming msg",n);n.end?(r.writeEnd&&delete this._outstreams[t],r.readEnd=!0,r.read(null,n.value),this._maybedone()):r.read(n.value)}else{t=n.req;var e=this._instreams[t];if(!e){var u=this;e=this._instreams[t]=new o(-1*t,this,(function(){delete u._instreams[t]})),this.opts&&"function"==typeof this.opts.stream&&this.opts.stream(e)}n.end?(e.writeEnd&&delete this._instreams[t],e.readEnd=!0,e.read&&e.read(null,n.value),this._maybedone()):e.read?e.read(n.value):console.error("no .read for stream:",e.id,"dropped:",n)}},o.prototype.write=function(n,t){if(t){this.writeEnd=t;var e=this._ps;e&&(e.read({req:this.id,stream:!0,end:!0,value:r(t)}),this.readEnd&&this.destroy(),e._maybedone())}else this._ps&&this._ps.read({req:this.id,stream:!0,end:!1,value:n})},o.prototype.end=function(n){this.write(null,r(n||!0))},o.prototype.destroy=function(n){if(this.writeEnd){if(!this.readEnd){this.readEnd=!0;try{this.read&&this.read(null,n)}catch(n){console.error("Exception thrown by PacketStream substream end handler",n),console.error(n.stack)}}}else{if(this.writeEnd=!0,!this.readEnd){this.readEnd=!0;try{this.read(null,n)}catch(n){console.error("Exception thrown by PacketStream substream end handler",n),console.error(n.stack)}}this.write(null,n)}this._ps&&(this._remove(),this._remove=null,this.read=u,this._ps=null)}},115:function(n,t,r){"use strict";var e=r(28);function u(t,r){return n.exports(t,(function(n){t.writeEnd||t.write(null,n||!0),r&&r(n)}))}n.exports=function(n,t){var r,u,o=[],i=!1,c=function(n){var t=!1;return function(r,e){t||(t=!0,n(r,e))}}((function(e,o){t&&t(e,o),n=null,t=null,r=null,u&&u(e||!0,(function(){}))}));return n.read=function(n,t){if(i=i||t,r){var e=r;r=null,e(i,n)}else i||o.push(n);i&&c(!0!==i?i:null)},{source:function(t,e){t?(n&&n.write(null,t),e(t),c(!0!==t?t:null)):o.length?e(null,o.shift()):i?e(i):r=e},sink:function(t){if(i)return t(i,(function(){})),u=null;u=t,e.drain((function(t){if(i)return!1;n.write(t)}),(function(t){n&&!n.writeEnd&&n.write(null,t||!0),c&&c(t)}))(t)}}},n.exports.source=function(n){return u(n).source},n.exports.sink=function(n,t){return u(n,t).sink},n.exports.duplex=n.exports},116:function(n,t,r){var e=r(117),u=r(118);n.exports=function(n,t){var r=e(t=t||"GOODBYE");return{source:u(n.source,r),sink:u(u.filter((function(n){if(n!==t)return!0;r.end()})),n.sink)}}},117:function(n,t){n.exports=function(n){var t,r,e;function u(u){return function(o,i){u(o,(function(u,o){if(u&&!e)return e=!0,i(null,n);u&&t?i(u):u?r=i:i(null,o)}))}}return u.end=function(){return t=!0,r&&r(t),u},u}},118:function(n,t,r){"use strict";var e=r(119),u=r(125),o=r(131);for(var i in t=n.exports=r(139),e)t[i]=e[i];for(var i in o)t[i]=o[i];for(var i in u)t[i]=u[i]},119:function(n,t,r){"use strict";n.exports={keys:r(120),once:r(63),values:r(39),count:r(121),infinite:r(122),empty:r(123),error:r(124)}},120:function(n,t,r){"use strict";var e=r(39);n.exports=function(n){return e(Object.keys(n))}},121:function(n,t,r){"use strict";n.exports=function(n){var t=0;return n=n||1/0,function(r,e){return r?e&&e(r):t>n?e(!0):void e(null,t++)}}},122:function(n,t,r){"use strict";n.exports=function(n){return n=n||Math.random,function(t,r){return t?r&&r(t):r(null,n())}}},123:function(n,t,r){"use strict";n.exports=function(){return function(n,t){t(!0)}}},124:function(n,t,r){"use strict";n.exports=function(n){return function(t,r){r(n)}}},125:function(n,t,r){"use strict";n.exports={drain:r(21),onEnd:r(126),log:r(127),find:r(128),reduce:r(40),collect:r(129),concat:r(130)}},126:function(n,t,r){"use strict";var e=r(21);n.exports=function(n){return e(null,n)}},127:function(n,t,r){"use strict";var e=r(21);n.exports=function(n){return e((function(n){console.log(n)}),n)}},128:function(n,t,r){"use strict";function e(n){return n}var u=r(22),o=r(21);n.exports=function(n,t){var r=!1;return t?n=u(n)||e:(t=n,n=e),o((function(e){if(n(e))return r=!0,t(null,e),!1}),(function(n){r||t(!0===n?null:n,null)}))}},129:function(n,t,r){"use strict";var e=r(40);n.exports=function(n){return e((function(n,t){return n.push(t),n}),[],n)}},130:function(n,t,r){"use strict";var e=r(40);n.exports=function(n){return e((function(n,t){return n+t}),"",n)}},131:function(n,t,r){"use strict";n.exports={map:r(132),asyncMap:r(133),filter:r(41),filterNot:r(134),through:r(135),take:r(136),unique:r(65),nonUnique:r(137),flatten:r(138)}},132:function(n,t,r){"use strict";function e(n){return n}var u=r(22);n.exports=function(n){return n?(n=u(n),function(t){return function(r,e){t(r,(function(r,u){try{u=r?null:n(u)}catch(n){return t(n,(function(){return e(n)}))}e(r,u)}))}}):e}},133:function(n,t,r){"use strict";function e(n){return n}var u=r(22);n.exports=function(n){if(!n)return e;n=u(n);var t,r,o=!1;return function(e){return function u(i,c){if(r)return c(r);i?(r=i,e(i,o?function(){o?t=c:c(i)}:c)):e(null,(function(e,i){e?c(e):r?c(r):(o=!0,n(i,(function(n,e){o=!1,r?(c(r),t(r)):n?u(n,c):c(null,e)})))}))}}}},134:function(n,t,r){"use strict";var e=r(64),u=r(41);n.exports=function(n){return n=e(n),u((function(t){return!n(t)}))}},135:function(n,t,r){"use strict";n.exports=function(n,t){var r=!1;function e(n){!r&&t&&(r=!0,t(!0===n?null:n))}return function(t){return function(r,u){return r&&e(r),t(r,(function(t,r){t?e(t):n&&n(r),u(t,r)}))}}}},136:function(n,t,r){"use strict";n.exports=function(n,t){var r=(t=t||{}).last||!1,e=!1;if("number"==typeof n){r=!0;var u=n;n=function(){return--u}}return function(t){function u(n){t(!0,(function(t){r=!1,n(t||!0)}))}return function(o,i){e?r?u(i):i(e):(e=o)?t(e,i):t(null,(function(t,o){(e=e||t)?i(e):n(o)?i(null,o):(e=!0,r?i(null,o):u(i))}))}}}},137:function(n,t,r){"use strict";var e=r(65);n.exports=function(n){return e(n,!0)}},138:function(n,t,r){"use strict";var e=r(39),u=r(63);n.exports=function(){return function(n){var t;return function(r,o){function i(){t(null,(function(t,r){!0===t?c():t?n(!0,(function(n){o(t)})):o(null,r)}))}function c(){t=null,n(null,(function(n,r){if(n)return o(n);Array.isArray(r)||r&&"object"==typeof r?r=e(r):"function"!=typeof r&&(r=u(r)),t=r,i()}))}r?t?t(r,(function(t){n(t||r,o)})):n(r,o):t?i():c()}}}},139:function(n,t,r){"use strict";n.exports=function n(t){var r=arguments.length;if("function"==typeof t&&1===t.length){for(var e=new Array(r),u=0;u<r;u++)e[u]=arguments[u];return function(t){if(null==e)throw new TypeError("partial sink should only be called once!");var u=e;switch(e=null,r){case 1:return n(t,u[0]);case 2:return n(t,u[0],u[1]);case 3:return n(t,u[0],u[1],u[2]);case 4:return n(t,u[0],u[1],u[2],u[3]);default:return u.unshift(t),n.apply(null,u)}}}var o=t;o&&"function"==typeof o.source&&(o=o.source);for(u=1;u<r;u++){var i=arguments[u];"function"==typeof i?o=i(o):i&&"object"==typeof i&&(i.sink(o),o=i.source)}return o}},140:function(n,t,r){"use strict";var e=r(20),u=r(66);function o(n,t,r,e){for(var u in t)!function(t,u){var i,c=r?r.concat(t):[t];n[t]=(i=u)&&"object"==typeof i?o({},u,c,e):function(){return e(u,c,[].slice.call(arguments))}}(u,t[u]);return n}function i(n){if(n)throw u(n,"callback not provided")}const c=["sync","async"];n.exports=function(n,t,r,u){function s(n,t,u){var o,s="function"==typeof u[u.length-1]?u.pop():c.includes(n)?null:i;if("function"==typeof s){try{o=r(n,t,u,s)}catch(t){return e.errorAsStreamOrCb(n,t,s)}return o}return new Promise((e,o)=>r(n,t,u,(n,t)=>{n?o(n):e(t)}))}return n=n||{},u?s("async","manifest",[function(t,r){if(t)return u(t);o(n,r,null,s),u(null,r,n)}]):o(n,t,null,s),n}},141:function(n,t,r){var e=r(142),u=r(20);n.exports=function(n,t,r){function o(n,r){return n===u.get(t,r)}function i(t,r,e){if("emit"===r)throw new Error("emit has been removed");if("async"===t&&o("sync",r)){var i,c=e.pop();try{i=u.get(n,r).apply(this,e)}catch(n){return c(n)}return c(null,i)}if(!o(t,r))throw new Error("no "+t+":"+r);return u.get(n,r).apply(this,e)}return r=e(r),function(n,t,e){var u=r.pre(t,e);if(u)throw u;return i.call(this,n,t,e)}}},142:function(n,t,r){"use strict";var e=r(20),u=Array.isArray;function o(n){return"function"==typeof n}function i(n){return u(n)?n:n.split(".")}n.exports=function(n){if((t=n)&&o(t.pre)&&o(t.test)&&o(t.post))return n;var t;if(o(n))return{pre:n};var r=null,c={};function s(n){return n.allow?(r={},n.allow.forEach((function(n){e.set(r,i(n),!0)}))):r=null,n.deny?n.deny.forEach((function(n){e.set(c,i(n),!0)})):c={},this}return n&&s(n),s.pre=function(n,t){return n=u(n)?n:[n],r&&!e.prefix(r,n)?new Error("method:"+n+" is not in list of allowed methods"):c&&e.prefix(c,n)?new Error("method:"+n+" is on list of disallowed methods"):void 0},s.post=function(n,t){},s.test=function(n,t){return s.pre(n,t)},s.get=function(){return{allow:r,deny:c}},s}},143:function(n,t,r){r(60);var e=r(61);function u(n){n.destroy?n.destroy():console.error("warning, stream-to-pull-stream: \nthe wrapped node-stream does not implement `destroy`, \nthis may cause resource leaks.")}function o(n,t,r){var o,i,c=!1;function s(){i||(i=!0,r&&r(!0===o?null:o))}function f(){c||(c=!0,a(),o?s():n(o=!0,s))}function l(t){a(),o||n(o=t,s)}function a(){t.on("finish",f),t.removeListener("close",f),t.removeListener("error",l)}t.on("close",f),t.on("finish",f),t.on("error",l),process.nextTick((function(){e((function(r){n(null,(function(n,e){if(o=o||n,!0===n)return t._isStdio?s():t.end();if(o=o||n)return u(t),s();t._isStdio?t.write(e,(function(){r()})):!1===t.write(e)?t.once("drain",r):r()}))}))}))}function i(n){var t,r=[],e=[],o=!1;function i(){for(;(r.length||t)&&e.length;)e.shift()(r.length?null:t,r.shift());!r.length&&o&&(o=!1,n.resume())}return n.on("data",(function(t){r.push(t),i(),r.length&&n.pause&&(o=!0,n.pause())})),n.on("end",(function(){t=!0,i()})),n.on("close",(function(){t=!0,i()})),n.on("error",(function(n){t=n,i()})),function(r,o){if(!o)throw new Error("*must* provide cb");if(r){function c(){for(;e.length;)e.shift()(r);o(r)}if(t)return c();n.once("close",c),u(n)}else e.push(o),i()}}var c=i,s=function(n,t){return function(r){return o(r,n,t)}},f=function(n){return i(n)};(t=n.exports=function(n,t){return n.writable&&n.write?n.readable?function(r){return o(r,n,t),i(n)}:s(n,t):f(n)}).sink=s,t.source=f,t.read=c,t.read1=i,t.read2=function(n){var t,r=!1,e=!1;function u(){var r=n.read();if(null!==r&&t){var e=t;t=null,e(null,r)}}return n.on("readable",(function(){e=!0,t&&u()})).on("end",(function(){r=!0,t&&t(r)})).on("error",(function(n){r=n,t&&t(r)})),function(n,o){t=o,r?o(r):e&&u()}},t.duplex=function(n,t){return{source:f(n),sink:s(n,t)}},t.transform=function(n){return function(t){var r=f(n);return s(n)(t),r}}},17:function(n,t){n.exports=require("events")},18:function(n,t,r){"use strict";n.exports=function(n,t){var r,e;function u(o){if(r=o,e)return u.abort();!function u(){for(var o=!0,i=!1;o;)if(i=!1,r(null,(function(c,s){if(i=!0,c=c||e){if(o=!1,t)t(!0===c?null:c);else if(c&&!0!==c)throw c}else n&&!1===n(s)||e?(o=!1,r(e||!0,t||function(){})):o||u()})),!i)return void(o=!1)}()}return u.abort=function(n,t){if("function"==typeof n&&(t=n,n=!0),e=n||!0,r)return r(e,t||function(){})},u}},19:function(n,t){n.exports=function(n){return n&&("string"==typeof n?function(t){return t[n]}:"object"==typeof n&&"function"==typeof n.exec?function(t){var r=n.exec(t);return r&&r[0]}:n)}},20:function(n,t,r){"use strict";var e=r(28);Array.isArray;t.set=function(n,t,r){for(var e,u,o=0;o<t.length;o++){var i=t[o];n[i]=n[i]||{},e=n,u=i,n=n[i]}e[u]=r},t.get=function(n,t){if("string"==typeof t)return n[t];for(var r,e=0;e<t.length;e++){if(r=n=n[t[e]],null==n)return n}return r},t.prefix=function(n,t){for(var r,e=0;e<t.length;e++){if(r=n=n[t[e]],"object"!=typeof n)return n;n}return"object"!=typeof r&&!!r};t.mount=function(n,t,r){if(!Array.isArray(t))throw new Error("path must be array of strings");return function(n,t){for(var r in t)n[r]=t[r];return n}(function(n,t){for(var r in t){var e=t[r];n[e]||(n[e]={}),n=n[e]}return n}(n,t),r)},t.unmount=function(n,t){return function(n,t){!function n(r,e){var u=t[e];r&&(t.length-1===e?delete r[u]:e<t.length&&n(r[u],e+1),function(n){for(var t in n)return!1;return!0}(r[u])&&delete r[u])}(n,0)}(n,t)};function u(n){return"source"===n}function o(n){return"sink"===n}function i(n){return"duplex"===n}function c(n){return function(t){t(n||!0,(function(){}))}}function s(n){return{source:e.error(n),sink:c(n)}}t.errorAsStream=function(n,t){return u(n)?e.error(t):o(n)?c(t):s(t)},t.errorAsStreamOrCb=function(n,t,r){return function(n){return"sync"===n}(i=n)||function(n){return"async"===n}(i)?r(t):u(n)?e.error(t):o(n)?c(t):r(t),s(t);var i},t.pipeToStream=function(n,t,r){u(n)?t(r):o(n)?r(t):i(n)&&e(t,r,t)}},21:function(n,t,r){"use strict";n.exports=function(n,t){var r,e;function u(o){if(r=o,e)return u.abort();!function u(){for(var o=!0,i=!1;o;)if(i=!1,r(null,(function(c,s){if(i=!0,c=c||e){if(o=!1,t)t(!0===c?null:c);else if(c&&!0!==c)throw c}else n&&!1===n(s)||e?(o=!1,r(e||!0,t||function(){})):o||u()})),!i)return void(o=!1)}()}return u.abort=function(n,t){if("function"==typeof n&&(t=n,n=!0),e=n||!0,r)return r(e,t||function(){})},u}},22:function(n,t){n.exports=function(n){return n&&("string"==typeof n?function(t){return t[n]}:"object"==typeof n&&"function"==typeof n.exec?function(t){var r=n.exec(t);return r&&r[0]}:n)}},28:function(n,t,r){"use strict";var e=r(88),u=r(94),o=r(100);for(var i in(t=n.exports=r(60)).pull=t,e)t[i]=e[i];for(var i in o)t[i]=o[i];for(var i in u)t[i]=u[i]},36:function(n,t,r){"use strict";var e=r(56);n.exports=function(n,t){if(!n)return function(n,r){return n?e(r,n,t):r(!0)};Array.isArray(n)||(n=Object.keys(n).map((function(t){return n[t]})));var r=0;return function(u,o){if(u)return e(o,u,t);r>=n.length?o(!0):o(null,n[r++])}}},37:function(n,t,r){"use strict";var e=r(18);n.exports=function(n,t,r){r||(r=t,t=null);var u=e((function(r){t=n(t,r)}),(function(n){r(n,t)}));return 2===arguments.length?function(n){n(null,(function(e,o){if(e)return r(!0===e?null:e);t=o,u(n)}))}:u}},38:function(n,t,r){"use strict";var e=r(58);n.exports=function(n){return n=e(n),function(t){return function r(e,u){for(var o,i=!0;i;)i=!1,o=!0,t(e,(function(t,e){if(!t&&!n(e))return o?i=!0:r(t,u);u(t,e)})),o=!1}}}},39:function(n,t,r){"use strict";var e=r(62);n.exports=function(n,t){if(!n)return function(n,r){return n?e(r,n,t):r(!0)};Array.isArray(n)||(n=Object.keys(n).map((function(t){return n[t]})));var r=0;return function(u,o){if(u)return e(o,u,t);r>=n.length?o(!0):o(null,n[r++])}}},40:function(n,t,r){"use strict";var e=r(21);n.exports=function(n,t,r){r||(r=t,t=null);var u=e((function(r){t=n(t,r)}),(function(n){r(n,t)}));return 2===arguments.length?function(n){n(null,(function(e,o){if(e)return r(!0===e?null:e);t=o,u(n)}))}:u}},41:function(n,t,r){"use strict";var e=r(64);n.exports=function(n){return n=e(n),function(t){return function r(e,u){for(var o,i=!0;i;)i=!1,o=!0,t(e,(function(t,e){if(!t&&!n(e))return o?i=!0:r(t,u);u(t,e)})),o=!1}}}},443:function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const e=r(55),u=r(10),o=r(1),i=r(28),c=r(6),s=r(108),f=r(143),l=JSON.parse(process.env.REMOTE_CONTAINERS_SOCKETS),a=s({...l.reduce((n,t)=>(n[t]="duplex",n),{}),rpc:"async",ready:"async"},null)();i(f.source(process.stdin),a.createStream(),f.sink(process.stdout));const p=l.map(async n=>{try{if(!(await c.promisify(o.lstat)(n)).isSocket())return;await c.promisify(o.unlink)(n)}catch(n){if(!n||"ENOENT"!==n.code)throw n}const t=e.createServer(t=>{t=f.duplex(t),i(t,a[n](n=>{n&&console.error("Remote to local stream terminated with error:",n)}),t)});return c.promisify(t.listen.bind(t))(n)});let h;p.push(new Promise(n=>h=n)),u.createServer((n,t)=>{const r=[];n.on("data",n=>r.push(n)),n.on("end",()=>{a.rpc(Buffer.concat(r).toString(),(n,r)=>{n?(console.error(n),t.writeHead(500),t.end()):(t.writeHead(200),t.write(r,n=>{n&&console.error(n)}),t.end())})})}).listen(process.env.REMOTE_CONTAINERS_IPC,h),Promise.all(p).then(()=>a.ready(n=>{n&&console.error(n)})).catch(n=>console.error(n))},55:function(n,t){n.exports=require("net")},56:function(n,t){n.exports=function(n,t,r){n(t),r&&r(!0===t?null:t)}},57:function(n,t,r){"use strict";var e=r(56);n.exports=function(n,t){return function(r,u){if(r)return e(u,r,t);if(null!=n){var o=n;n=null,u(null,o)}else u(!0)}}},58:function(n,t,r){var e=r(19);function u(n){return n}n.exports=function(n){return"object"==typeof n&&"function"==typeof n.test?function(t){return n.test(t)}:e(n)||u}},59:function(n,t,r){"use strict";function e(n){return n}var u=r(19),o=r(38);n.exports=function(n,t){n=u(n)||e;var r={};return o((function(e){var u=n(e);return r[u]?!!t:(r[u]=!0,!t)}))}},6:function(n,t){n.exports=require("util")},60:function(n,t,r){"use strict";n.exports=function n(t){var r=arguments.length;if("function"==typeof t&&1===t.length){for(var e=new Array(r),u=0;u<r;u++)e[u]=arguments[u];return function(t){if(null==e)throw new TypeError("partial sink should only be called once!");var u=e;switch(e=null,r){case 1:return n(t,u[0]);case 2:return n(t,u[0],u[1]);case 3:return n(t,u[0],u[1],u[2]);case 4:return n(t,u[0],u[1],u[2],u[3]);default:return u.unshift(t),n.apply(null,u)}}}var o=t;o&&"function"==typeof o.source&&(o=o.source);for(u=1;u<r;u++){var i=arguments[u];"function"==typeof i?o=i(o):i&&"object"==typeof i&&(i.sink(o),o=i.source)}return o}},61:function(n,t){n.exports=function(n){!function t(){var r=!0,e=!1;do{e=!0,r=!1,n.call(this,(function(){e?r=!0:t()})),e=!1}while(r)}()}},62:function(n,t){n.exports=function(n,t,r){n(t),r&&r(!0===t?null:t)}},63:function(n,t,r){"use strict";var e=r(62);n.exports=function(n,t){return function(r,u){if(r)return e(u,r,t);if(null!=n){var o=n;n=null,u(null,o)}else u(!0)}}},64:function(n,t,r){var e=r(22);function u(n){return n}n.exports=function(n){return"object"==typeof n&&"function"==typeof n.test?function(t){return n.test(t)}:e(n)||u}},65:function(n,t,r){"use strict";function e(n){return n}var u=r(22),o=r(41);n.exports=function(n,t){n=u(n)||e;var r={};return o((function(e){var u=n(e);return r[u]?!!t:(r[u]=!0,!t)}))}},66:function(n,t){function r(n){return n.stack&&n.name&&n.message?n.stack.substring(n.name.length+3+n.message.length).split("\n"):n.stack?n.stack.split("\n"):void 0}n.exports=function(n,t){if(!(n.stack&&n.name&&n.message))return console.error(new Error("stackless error")),n;var e,u,o=new Error(t),i=(e=r(o).slice(1),u=r(n),e.filter((function(n){return!~u.indexOf(n)}))).join("\n");return o.__proto__=n,o.stack=o.name+": "+o.message+"\n"+i+"\n  "+n.stack,o}},88:function(n,t,r){"use strict";n.exports={keys:r(89),once:r(57),values:r(36),count:r(90),infinite:r(91),empty:r(92),error:r(93)}},89:function(n,t,r){"use strict";var e=r(36);n.exports=function(n){return e(Object.keys(n))}},90:function(n,t,r){"use strict";n.exports=function(n){var t=0;return n=n||1/0,function(r,e){return r?e&&e(r):t>n?e(!0):void e(null,t++)}}},91:function(n,t,r){"use strict";n.exports=function(n){return n=n||Math.random,function(t,r){return t?r&&r(t):r(null,n())}}},92:function(n,t,r){"use strict";n.exports=function(){return function(n,t){t(!0)}}},93:function(n,t,r){"use strict";n.exports=function(n){return function(t,r){r(n)}}},94:function(n,t,r){"use strict";n.exports={drain:r(18),onEnd:r(95),log:r(96),find:r(97),reduce:r(37),collect:r(98),concat:r(99)}},95:function(n,t,r){"use strict";var e=r(18);n.exports=function(n){return e(null,n)}},96:function(n,t,r){"use strict";var e=r(18);n.exports=function(n){return e((function(n){console.log(n)}),n)}},97:function(n,t,r){"use strict";function e(n){return n}var u=r(19),o=r(18);n.exports=function(n,t){var r=!1;return t?n=u(n)||e:(t=n,n=e),o((function(e){if(n(e))return r=!0,t(null,e),!1}),(function(n){r||t(!0===n?null:n,null)}))}},98:function(n,t,r){"use strict";var e=r(37);n.exports=function(n){return e((function(n,t){return n.push(t),n}),[],n)}},99:function(n,t,r){"use strict";var e=r(37);n.exports=function(n){return e((function(n,t){return n+t}),"",n)}}}));
//# sourceMappingURL=remoteContainersServer.js.map