!function(t,e){for(var n in e)t[n]=e[n]}(exports,function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=439)}({0:function(t,e){t.exports=require("path")},1:function(t,e){t.exports=require("fs")},10:function(t,e){t.exports=require("http")},13:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(1),o=n(6),s=n(80);e.isLocalFile=function(t){return new Promise(e=>r.stat(t,(t,n)=>e(!t&&n.isFile())))},e.readLocalFile=o.promisify(r.readFile),e.writeLocalFile=o.promisify(r.writeFile),e.renameLocal=o.promisify(r.rename),e.readLocalDir=o.promisify(r.readdir),e.unlinkLocal=o.promisify(r.unlink),e.mkdirpLocal=o.promisify(s),e.rmdirLocal=o.promisify(r.rmdir)},146:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),o=n(10),s=n(8),i=n(25);e.createServer=async function(t,e){const n=function(t){if("win32"===process.platform)return`\\\\.\\pipe\\${t}-sock`;if(process.env.XDG_RUNTIME_DIR)return r.join(process.env.XDG_RUNTIME_DIR,`${t}.sock`);return r.join(s.tmpdir(),`${t}.sock`)}(`${t}-${(await async function(t){return new Promise((e,n)=>{i.randomBytes(t,(t,r)=>{t?n(t):e(r)})})}(20)).toString("hex")}`),o=new c(n,e);return o.listen(),o};class c{constructor(t,e){this.ipcHandlePath=t,this.server=o.createServer((t,n)=>{Promise.resolve(e(t,n)).catch(t=>console.error(t&&t.message||t))}),this.server.on("error",t=>console.error(t))}listen(){this.server.listen(this.ipcHandlePath)}dispose(){this.server.close()}}e.Server=c,e.readJSON=async function(t){return new Promise((e,n)=>{const r=[];t.setEncoding("utf8"),t.on("data",t=>r.push(t)),t.on("error",t=>n(t)),t.on("end",()=>{const t=JSON.parse(r.join(""));e(t)})})},e.sendData=async function(t,e){return new Promise((n,r)=>{const s={socketPath:t,path:"/",method:"POST"},i=o.request(s,t=>n(t));i.on("error",t=>r(t)),i.write(e),i.end()})};e.Queue=class{constructor(){this.messages=[]}push(t){this.messages.push(t),this.dequeueRequest&&(this.dequeueRequest.resolve(this.messages),this.dequeueRequest=void 0,this.messages=[])}async dequeue(t){if(this.messages.length){const t=this.messages;return this.messages=[],t}return this.dequeueRequest&&this.dequeueRequest.resolve([]),new Promise((e,n)=>{this.dequeueRequest={resolve:e,reject:n},"number"==typeof t&&setTimeout(n,t)})}}},15:function(t,e,n){"use strict";n.r(e),n.d(e,"URI",(function(){return m}));var r,o,s,i=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});if("object"==typeof process)s="win32"===process.platform;else if("object"==typeof navigator){var c=navigator.userAgent;s=c.indexOf("Windows")>=0}var a=/^\w[\w\d+.-]*$/,u=/^\//,d=/^\/\//;var l="",f="/",p=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,m=function(){function t(t,e,n,r,o,s){void 0===s&&(s=!1),"object"==typeof t?(this.scheme=t.scheme||l,this.authority=t.authority||l,this.path=t.path||l,this.query=t.query||l,this.fragment=t.fragment||l):(this.scheme=function(t,e){return t||e?t:"file"}(t,s),this.authority=e||l,this.path=function(t,e){switch(t){case"https":case"http":case"file":e?e[0]!==f&&(e=f+e):e=f}return e}(this.scheme,n||l),this.query=r||l,this.fragment=o||l,function(t,e){if(!t.scheme&&e)throw new Error('[UriError]: Scheme is missing: {scheme: "", authority: "'+t.authority+'", path: "'+t.path+'", query: "'+t.query+'", fragment: "'+t.fragment+'"}');if(t.scheme&&!a.test(t.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(t.path)if(t.authority){if(!u.test(t.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(d.test(t.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}(this,s))}return t.isUri=function(e){return e instanceof t||!!e&&("string"==typeof e.authority&&"string"==typeof e.fragment&&"string"==typeof e.path&&"string"==typeof e.query&&"string"==typeof e.scheme&&"function"==typeof e.fsPath&&"function"==typeof e.with&&"function"==typeof e.toString)},Object.defineProperty(t.prototype,"fsPath",{get:function(){return S(this)},enumerable:!0,configurable:!0}),t.prototype.with=function(t){if(!t)return this;var e=t.scheme,n=t.authority,r=t.path,o=t.query,s=t.fragment;return void 0===e?e=this.scheme:null===e&&(e=l),void 0===n?n=this.authority:null===n&&(n=l),void 0===r?r=this.path:null===r&&(r=l),void 0===o?o=this.query:null===o&&(o=l),void 0===s?s=this.fragment:null===s&&(s=l),e===this.scheme&&n===this.authority&&r===this.path&&o===this.query&&s===this.fragment?this:new g(e,n,r,o,s)},t.parse=function(t,e){void 0===e&&(e=!1);var n=p.exec(t);return n?new g(n[2]||l,decodeURIComponent(n[4]||l),decodeURIComponent(n[5]||l),decodeURIComponent(n[7]||l),decodeURIComponent(n[9]||l),e):new g(l,l,l,l,l)},t.file=function(t){var e=l;if(s&&(t=t.replace(/\\/g,f)),t[0]===f&&t[1]===f){var n=t.indexOf(f,2);-1===n?(e=t.substring(2),t=f):(e=t.substring(2,n),t=t.substring(n)||f)}return new g("file",e,t,l,l)},t.from=function(t){return new g(t.scheme,t.authority,t.path,t.query,t.fragment)},t.prototype.toString=function(t){return void 0===t&&(t=!1),x(this,t)},t.prototype.toJSON=function(){return this},t.revive=function(e){if(e){if(e instanceof t)return e;var n=new g(e);return n._formatted=e.external,n._fsPath=e._sep===h?e.fsPath:null,n}return e},t}(),h=s?1:void 0,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._formatted=null,e._fsPath=null,e}return i(e,t),Object.defineProperty(e.prototype,"fsPath",{get:function(){return this._fsPath||(this._fsPath=S(this)),this._fsPath},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){return void 0===t&&(t=!1),t?x(this,!0):(this._formatted||(this._formatted=x(this,!1)),this._formatted)},e.prototype.toJSON=function(){var t={$mid:1};return this._fsPath&&(t.fsPath=this._fsPath,t._sep=h),this._formatted&&(t.external=this._formatted),this.path&&(t.path=this.path),this.scheme&&(t.scheme=this.scheme),this.authority&&(t.authority=this.authority),this.query&&(t.query=this.query),this.fragment&&(t.fragment=this.fragment),t},e}(m),y=((o={})[58]="%3A",o[47]="%2F",o[63]="%3F",o[35]="%23",o[91]="%5B",o[93]="%5D",o[64]="%40",o[33]="%21",o[36]="%24",o[38]="%26",o[39]="%27",o[40]="%28",o[41]="%29",o[42]="%2A",o[43]="%2B",o[44]="%2C",o[59]="%3B",o[61]="%3D",o[32]="%20",o);function w(t,e){for(var n=void 0,r=-1,o=0;o<t.length;o++){var s=t.charCodeAt(o);if(s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||45===s||46===s||95===s||126===s||e&&47===s)-1!==r&&(n+=encodeURIComponent(t.substring(r,o)),r=-1),void 0!==n&&(n+=t.charAt(o));else{void 0===n&&(n=t.substr(0,o));var i=y[s];void 0!==i?(-1!==r&&(n+=encodeURIComponent(t.substring(r,o)),r=-1),n+=i):-1===r&&(r=o)}}return-1!==r&&(n+=encodeURIComponent(t.substring(r))),void 0!==n?n:t}function v(t){for(var e=void 0,n=0;n<t.length;n++){var r=t.charCodeAt(n);35===r||63===r?(void 0===e&&(e=t.substr(0,n)),e+=y[r]):void 0!==e&&(e+=t[n])}return void 0!==e?e:t}function S(t){var e;return e=t.authority&&t.path.length>1&&"file"===t.scheme?"//"+t.authority+t.path:47===t.path.charCodeAt(0)&&(t.path.charCodeAt(1)>=65&&t.path.charCodeAt(1)<=90||t.path.charCodeAt(1)>=97&&t.path.charCodeAt(1)<=122)&&58===t.path.charCodeAt(2)?t.path[1].toLowerCase()+t.path.substr(2):t.path,s&&(e=e.replace(/\//g,"\\")),e}function x(t,e){var n=e?v:w,r="",o=t.scheme,s=t.authority,i=t.path,c=t.query,a=t.fragment;if(o&&(r+=o,r+=":"),(s||"file"===o)&&(r+=f,r+=f),s){var u=s.indexOf("@");if(-1!==u){var d=s.substr(0,u);s=s.substr(u+1),-1===(u=d.indexOf(":"))?r+=n(d,!1):(r+=n(d.substr(0,u),!1),r+=":",r+=n(d.substr(u+1),!1)),r+="@"}-1===(u=(s=s.toLowerCase()).indexOf(":"))?r+=n(s,!1):(r+=n(s.substr(0,u),!1),r+=s.substr(u))}if(i){if(i.length>=3&&47===i.charCodeAt(0)&&58===i.charCodeAt(2))(l=i.charCodeAt(1))>=65&&l<=90&&(i="/"+String.fromCharCode(l+32)+":"+i.substr(3));else if(i.length>=2&&58===i.charCodeAt(1)){var l;(l=i.charCodeAt(0))>=65&&l<=90&&(i=String.fromCharCode(l+32)+":"+i.substr(2))}r+=n(i,!0)}return c&&(r+="?",r+=n(c,!1)),a&&(r+="#",r+=e?a:w(a,!1)),r}},16:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(3),o=n(4);async function s(t,e){const n=await i(t,"container",e);for(const t of n){t.Ports=[];const e=t.NetworkSettings.Ports;for(const n in e){const[r,o]=n.split("/");for(const s of e[n]||[]){const{HostIp:e,HostPort:n}=s;t.Ports.push({IP:e,PrivatePort:parseInt(r),PublicPort:parseInt(n),Type:o})}}}return n}async function i(t,e,n){if(!n.length)return[];const o=await r.runCommandNoPty({...u(t),args:["inspect","--type",e,...n]});try{return JSON.parse(o.stdout.toString())}catch(t){throw console.error({stdout:o.stdout.toString(),stderr:o.stderr.toString()}),t}}async function c(t,...e){return r.runCommandNoPty({...u(t),args:e})}async function a(t){const e="cliHost"in t?t.cliHost:t.common.cliHost;if("linux"!==e.platform)return!1;try{const n=(await r.runCommandNoPty({...u(t),cmd:"/bin/sh",args:["-c",`a="$(which '${t.dockerCLI}')" && realpath "$a"`]})).stdout.toString().trim();return"podman"===e.path.basename(n)}catch(t){return!1}}function u(t){return"dockerEnv"in t?{exec:t.common.cliHost.exec,cmd:t.dockerCLI,env:t.dockerEnv,output:t.common.output}:"cliHost"in t?{exec:t.cliHost.exec,cmd:t.dockerCLI,env:t.env,output:t.output}:t}function d(t){return"dockerEnv"in t?{ptyExec:t.common.cliHost.ptyExec,cmd:t.dockerCLI,env:t.dockerEnv,output:t.common.output}:t}e.inspectContainer=async function(t,e){return(await s(t,[e]))[0]},e.inspectContainers=s,e.inspectImage=async function(t,e){return(await i(t,"image",[e]))[0]},e.inspectVolume=async function(t,e){return(await i(t,"volume",[e]))[0]},e.inspectVolumes=async function(t,e){return i(t,"volume",e)},e.listContainers=async function(t,e=!1,n=[]){const r=[];e&&r.push("-a");for(const t of n)r.push("--filter",`label=${t}`);return(await c(t,"ps","-q",...r)).stdout.toString().split(/\r?\n/).filter(t=>!!t)},e.listVolumes=async function(t,e=[]){const n=[];for(const t of e)n.push("--filter",`label=${t}`);return(await c(t,"volume","ls","-q",...n)).stdout.toString().split(/\r?\n/).filter(t=>!!t)},e.listDanglingVolumes=async function(t){return(await c(t,"volume","ls","-q","-f","dangling=true")).stdout.toString().split(/\r?\n/).filter(t=>!!t)},e.createVolume=async function(t,e,n){const r=[];for(const t of n)r.push("--label",t);await c(t,"volume","create",...r,e)},e.getEvents=async function(t,e){const{exec:n,cmd:r,env:s,output:i}=u(t),c=[];for(const t in e)for(const n of e[t])c.push("--filter",`${t}=${n}`);const d=["events","--format",await a(t)?"json":"{{json .}}",...c],l=await n({cmd:r,args:d,env:s,output:i}),f=[];return l.stderr.on("data",t=>f.push(t)),l.exit.catch(t=>{i.write(o.toErrorText(t&&(t.stack||t.message)))}),l.exit.then(({code:t,signal:e})=>{f.length&&i.write(o.toErrorText(Buffer.concat(f).toString())),(t||e&&"SIGKILL"!==e)&&i.write(o.toErrorText(`Docker events terminated (code: ${t}, signal: ${e}).`))}),l},e.dockerCLI=c,e.isPodman=a,e.dockerPtyCLI=async function(t,...e){return r.runCommand({...d(t),args:e})},e.dockerComposeCLI=async function(t,...e){return r.runCommandNoPty({...u(t),cmd:"docker-compose",args:e})},e.dockerComposePtyCLI=async function(t,...e){return r.runCommand({...d(t),cmd:"docker-compose",args:e})},e.dockerExecFunction=function(t,e,n){const{exec:r,cmd:o,env:s}=u(t);return async function(t){const{env:i,cwd:c,cmd:a,args:u,output:d}=t,l=["exec","-i"];return n&&l.push("-u",n),i&&Object.keys(i).forEach(t=>l.push("-e",`${t}=${i[t]}`)),c&&l.push("-w",c),l.push(e,a),u&&l.push(...u),r({cmd:o,args:l,env:s,output:d})}}},25:function(t,e){t.exports=require("crypto")},3:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),o=n(8),s=n(1),i=n(43),c=n(4),a=n(13),u=n(15);function d(t,e,n){return"linux"===t?e===n:e.toLowerCase()===n.toLowerCase()}async function l(t){const{exec:e,cmd:n,args:r,cwd:o,env:i,stdin:a,output:u,print:d}=t,l=await e({cmd:n,args:r,cwd:o,env:i,output:u});return new Promise((t,e)=>{const o=[],i=[];l.stdout.on("data",t=>{o.push(t)}),l.stderr.on("data",t=>{i.push(t)}),l.exit.catch(e),l.exit.then(({code:s})=>{try{const a=Buffer.concat(o),l=Buffer.concat(i);d&&(u.write(a.toString().replace(/\r?\n/g,"\r\n")),u.write(c.toErrorText(l.toString()))),s?e({message:`Command failed: ${n} ${(r||[]).join(" ")}`,stdout:a,stderr:l,code:s}):t({stdout:a,stderr:l})}catch(t){e(t)}}),a instanceof Buffer?l.stdin.write(a,t=>{t?e(t):l.stdin.end()}):a instanceof s.ReadStream&&a.pipe(l.stdin)})}function f(t){return async function(e){const{cmd:n,args:r,output:o}=e,s=`Run: ${n} ${(r||[]).join(" ").replace(/\n.*/g,"")}`,c=o.start(s),a=e.cwd||t,u=e.env?{...process.env,...e.env}:process.env,d=await g(n,a,u),l=i.spawn(d,r,{cwd:a,env:u});return{stdin:l.stdin,stdout:l.stdout,stderr:l.stderr,exit:new Promise((t,e)=>{l.once("error",t=>{o.stop(s,c),e(t)}),l.once("exit",(e,n)=>{o.stop(s,c),t({code:e,signal:n})})}),async terminate(){l.kill("SIGKILL")}}}}async function p(t,e){const n=await e("node-pty");if(!n)throw new Error("Missing node-pty");return async function(e){const{cmd:r,args:o,cols:s,rows:i,output:c}=e,a=`Run: ${r} ${(o||[]).join(" ").replace(/\n.*/g,"")}`,u=c.start(a),d=e.cwd||t,l=e.env?{...process.env,...e.env}:process.env,f=await g(r,d,l),p=n.spawn(f,o||[],{cwd:d,env:l,cols:s,rows:i,useConpty:!1});return{onData:p.onData.bind(p),resize:p.resize.bind(p),exit:new Promise(t=>{p.onExit(({exitCode:e,signal:n})=>{c.stop(a,u),t({code:e,signal:n})})}),async terminate(){p.kill("SIGKILL")}}}}function m(t,e,n){return async function(r){const{env:o,cmd:s,args:c,output:a}=r,u=r.cwd||n,d=u?`cd '${u}' && `:"",l=Object.keys(o||{}).map(t=>`${t}='${o[t]}' `).join(""),f=(c||[]).map(t=>` '${t.replace(/'/g,"'\"'\"'")}'`).join(""),p=[...e,"/bin/sh","-c",`${d}${l}${s}${f}`],m=`Run: ${t} ${p.join(" ").replace(/\n.*/g,"")}`,h=a.start(m),y=await g(t,process.cwd(),process.env),w=i.spawn(y,p);return{stdin:w.stdin,stdout:w.stdout,stderr:w.stderr,exit:new Promise((t,e)=>{w.once("error",t=>{a.stop(m,h),e(t)}),w.once("exit",(e,n)=>{a.stop(m,h),t({code:e,signal:n})})}),async terminate(){w.kill("SIGKILL")}}}}async function h(t,e,n,r){const o=await r("node-pty");if(!o)throw new Error("Missing node-pty");return async function(r){const{env:s,cmd:i,args:c,cols:a,rows:u,output:d}=r,l=r.cwd||n,f=l?`cd '${l}' && `:"",p=Object.keys(s||{}).map(t=>`${t}='${s[t]}' `).join(""),m=(c||[]).map(t=>` '${t.replace(/'/g,"'\"'\"'")}'`).join(""),h=[...e,"/bin/sh","-c",`${f}${p}${i}${m}`],y=`Run: ${t} ${h.join(" ").replace(/\n.*/g,"")}`,w=d.start(y),v=await g(t,process.cwd(),process.env),S=o.spawn(v,h,{cols:a,rows:u,useConpty:!1});return{onData:S.onData.bind(S),resize:S.resize.bind(S),exit:new Promise(t=>{S.onExit(({exitCode:e,signal:n})=>{d.stop(y,w),t({code:e,signal:n})})}),async terminate(){S.kill("SIGKILL")}}}}async function g(t,e=process.cwd(),n){if("win32"!==process.platform)return t;if(r.isAbsolute(t))return t;if("."!==r.dirname(t))return r.join(e,t);let o=void 0;if(n)for(let t of Object.keys(n))if("path"===t.toLowerCase()){const e=n[t];"string"==typeof e&&(o=e.split(r.delimiter));break}if(void 0===o||0===o.length)return r.join(e,t);const s=r.extname(t);for(let n of o){let o;if(o=r.isAbsolute(n)?r.join(n,t):r.join(e,n,t),s&&await a.isLocalFile(o))return o;let i=o+".com";if(await a.isLocalFile(i))return i;if(i=o+".exe",await a.isLocalFile(i))return i}return r.join(e,t)}!function(t){t[t.Trace=1]="Trace",t[t.Debug=2]="Debug",t[t.Info=3]="Info",t[t.Warning=4]="Warning",t[t.Error=5]="Error",t[t.Critical=6]="Critical",t[t.Off=7]="Off"}(e.LogLevel||(e.LogLevel={})),e.nullLog={write:()=>void 0,raw:()=>void 0,start:()=>Date.now(),stop:()=>void 0,setLogLevel:()=>void 0,logFilePath:""},e.equalPaths=d,e.isEqualOrParent=function({platform:t,path:e},n,r){return n===r||!(!n||!r)&&(!(r.length>n.length)&&(!(n.length>r.length&&n.charAt(r.length)!==e.sep)&&d(t,r,n.substr(0,r.length))))},e.findProcesses=async function(t){const{stdout:e}=await t.exec("for pid in `cd /proc && ls -d [0-9]*`; do { echo $pid ; readlink -f /proc/$pid/cwd ; xargs -0 < /proc/$pid/environ ; xargs -0 < /proc/$pid/cmdline ; } ; echo ; done 2>/dev/null",{logOutput:!1});return e.split("\n\n").map(t=>t.split("\n")).filter(t=>t.length>=4).map(t=>({pid:t[0],cwd:t[1],cmd:t[3],env:t[2].split(" ").reduce((t,e)=>{const n=e.indexOf("=");return-1!==n&&(t[e.substr(0,n)]=e.substr(n+1)),t},{})}))},e.tsnode=r.join(__dirname,"..","..","node_modules",".bin","ts-node"),e.isTsnode="ts-node"===r.basename(process.argv[0])||-1!==process.argv.indexOf("ts-node/register"),e.runCommandNoPty=l,e.runCommand=async function(t){var e,n;const{ptyExec:r,cmd:o,args:s,cwd:i,env:c,output:a,resolveOn:u}=t,d=await r({cmd:o,args:s,cwd:i,env:c,cols:null===(e=a.dimensions)||void 0===e?void 0:e.columns,rows:null===(n=a.dimensions)||void 0===n?void 0:n.rows,output:a});return new Promise((t,e)=>{let n="";const r=a.onDidChangeDimensions&&a.onDidChangeDimensions(t=>{d.resize(t.columns,t.rows)});d.onData(e=>{n+=e,a.raw(e),u&&u.exec(n)&&t({cmdOutput:n})}),d.exit.catch(e),d.exit.then(({code:i})=>{try{r&&r.dispose(),i?e({message:`Command failed: ${o} ${(s||[]).join(" ")}`,cmdOutput:n,code:i}):t({cmdOutput:n})}catch(t){e(t)}})})},e.plainExec=f,e.plainPtyExec=p,e.execFunction=m,e.ptyExecFunction=h,e.getExecFunction=async function(t,e){if(w(t)){const n=v(t);return m("wsl",["-d",n,"-e"],await S(n,t,e))}return f(t)},e.getCLIHost=async function(t,e,n,s){if("string"!=typeof t||n&&w(t)){const n="string"==typeof t?v(t):t.wslDistro,o="string"==typeof t?await S(n,t,s):t.wslPath,i=m("wsl",["-d",n,"-e"],o),c=await h("wsl",["-d",n,"-e"],o,e),a={type:"wsl",platform:"linux",exec:i,ptyExec:c,cwd:o,env:{},path:r.posix,async homedir(){return this.env.HOME},async tmpdir(){return this.env.TMPDIR||"/tmp"},isFile:async t=>{try{return await l({exec:i,cmd:"test",args:["-f",t],output:s}),!0}catch(t){return console.log(t),!1}},readFile:async t=>{try{return(await l({exec:i,cmd:"cat",args:[t],output:s})).stdout}catch(e){console.log(e);const n=new Error(`Could not read file: ${t}`);throw n.originalError=e,n.code="ENOENT",n}},writeFile:async(t,e)=>{await l({exec:i,cmd:"/bin/sh",args:["-c",`cat >'${t}'`],stdin:e,output:s})},rename:async(t,e)=>{await l({exec:i,cmd:"mv",args:[t,e],output:s})},mkdirp:async t=>{await l({exec:i,cmd:"mkdir",args:["-p",t],output:s})},readDir:async t=>(await l({exec:i,cmd:"ls",args:["-a",t],output:s})).stdout.toString().split("\n"),getuid:async()=>{const t=await l({exec:i,cmd:"id",args:["-u"],output:s});return parseInt(t.stdout.toString().trim(),10)},getgid:async()=>{const t=await l({exec:i,cmd:"id",args:["-g"],output:s});return parseInt(t.stdout.toString().trim(),10)},toCommonURI:async t=>{try{return u.URI.file((await l({exec:i,cmd:"wslpath",args:["-w",t],output:s})).stdout.toString().trim())}catch(t){return}}};return a.env=await async function(t,e){const{stdout:n}=await l({exec:t.exec,cmd:"printenv",output:e}),r=n.toString().trim();let o={};return r.split("\n").forEach(t=>{const e=t.split("=");o[e[0]]=e[1]}),o}(a,s),a}return{type:"local",platform:process.platform,exec:f(t),ptyExec:await p(t,e),cwd:t,env:process.env,path:r,homedir:async()=>o.homedir(),tmpdir:async()=>o.tmpdir(),isFile:a.isLocalFile,readFile:a.readLocalFile,writeFile:a.writeLocalFile,rename:a.renameLocal,mkdirp:async t=>{await a.mkdirpLocal(t)},readDir:a.readLocalDir,getuid:async()=>process.getuid(),getgid:async()=>process.getgid(),toCommonURI:async t=>u.URI.file(t)}};const y="\\\\wsl$\\";function w(t){return t.toLowerCase().startsWith(y)}function v(t){const e=t.toLowerCase();if(!e.startsWith(y))return"";const n=e.indexOf("\\",y.length);return t.substring(y.length,n)}async function S(t,e,n){const{stdout:r}=await l({exec:f(void 0),cmd:"wsl",args:["-d",t,"-e","wslpath","-u",e],output:n});return r.toString().trim()}e.isWslPath=w,e.getWslDistroNameFromPath=v,e.getWslPath=S,e.toWslPath=async function(t,e){if(w(t)){return S(v(t),t,e)}return t},e.toWslRemoteURI=async function(t,e){const n=v(t),r=await S(n,t,e);return u.URI.parse(`vscode-remote://wsl+${n}${r}`)}},33:function(t,e){t.exports=require("string_decoder")},4:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class r extends Error{constructor(t){super(t.originalError&&t.originalError.message||t.description),this.manageContainer=!1,this.actions=[],this.data={},Object.assign(this,t)}}e.ContainerError=r,e.bailOut=function(t,e){throw t.write(`[1m[31m${e}[39m[22m\n`),new Error(e)},e.toErrorText=function(t){return t.split(/\r?\n/).map(t=>`[1m[31m${t}[39m[22m`).join("\r\n")+"\r\n"},e.toWarningText=function(t){return t.split(/\r?\n/).map(t=>`[1m[33m${t}[39m[22m`).join("\r\n")+"\r\n"}},43:function(t,e){t.exports=require("child_process")},439:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(146),o=n(0),s=n(440),i=n(441),c=n(49),a=n(3),u=n(442),d=process.argv[2],l=process.argv[3];let f=a.LogLevel[process.argv[4]]||a.LogLevel.Info;const p=o.join(process.argv[5],"shutdownMonitor.log");const m=c.createLog((function(t){a.LogLevel.Trace>=f&&r.sendData(d,JSON.stringify({type:"trace",message:t})).catch(t=>{console.error(t)})}),!1,p);m.setLogLevel(f),m.write("Starting monitor process...");const h=Date.now();let g;async function y(t){if(m.write(`Cleaning up after ${Date.now()-h} ms...`),g)switch(g.delay&&(m.write(`Delaying for ${g.delay} ms.`),await u.delay(g.delay)),l){case"dockerCompose":await s.dockerComposeShutdown(g,m);break;case"singleContainer":await i.singleContainerShutdown(g,m);break;case"test":const{stdout:t,stderr:e}=await a.runCommandNoPty({exec:await a.getExecFunction(g.cwd,m),cmd:g.cmd,args:g.args,env:g.env,output:m});m.write("Command output: "+JSON.stringify({stdout:t.toString(),stderr:e.toString()}));break;default:m.write(`Type does not exist: ${l}`)}else m.write("Not configured!");if(m.write("Done."),t)try{const t=await r.sendData(d,JSON.stringify({type:"done"})),e=await r.readJSON(t);m.write("Received reply: "+JSON.stringify(e))}catch(t){m.write("Error confirming to extension: "+(t&&(t.stack||t.message)||String(t)))}}(async()=>{let t=0;for(;;)try{const e=await r.sendData(d,JSON.stringify({type:"poll"})),n=await r.readJSON(e);m.write("Received message: "+JSON.stringify(n));for(const t of n){if("cleanup"===t.type){try{await y(!0)}catch(t){m.write("Unexpected error: "+(t&&(t.stack||t.message)||String(t)))}return}"configure"===t.type&&((g=t.options).logLevel&&(f=g.logLevel,m.setLogLevel(f)),r.sendData(d,JSON.stringify({type:"reply",sequence:t.sequence})).catch(t=>{m.write("Error confirming configuration: "+(t&&(t.stack||t.message)||String(t)))}))}t=0}catch(e){if(m.write("Error polling extension: "+(e&&(e.stack||e.message)||String(e))),e&&("ECONNREFUSED"===e.code||"ENOENT"===e.code))return void await y(!1);++t>=5&&await u.delay(1e3)}})().catch(t=>{m.write("Unexpected error: "+(t&&(t.stack||t.message)||String(t)))})},44:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(33),o="␄";async function s(t,e=1){return new Promise(n=>{const s=new r.StringDecoder("utf8"),i=[],c=[];function a(r){!function r(s){const u=s.indexOf(o);-1!==u?(i.push(s.substr(0,u)),c.push(i.join("")),i.length=0,c.length===e?(n(c),t.off("data",a)):r(s.substr(u+1))):i.push(s)}(s.write(r))}t.on("data",a)})}e.launch=async function(t,e,n){const r=await t({env:n?{VSCODE_REMOTE_CONTAINERS_SESSION:n}:{},cmd:"/bin/sh",args:[],output:e}),i=function(t){let e;const n=new Promise((t,n)=>e=n),r=[],o=[],s=t=>r.push(t),i=t=>o.push(t);return t.stdout.on("data",s),t.stderr.on("data",i),t.exit.then(({code:t,signal:n})=>{e(`Shell server terminated (code: ${t}, signal: ${n})\n${Buffer.concat(r).toString()}\n${Buffer.concat(o).toString()}`)},t=>{e(`Shell server failed: ${t&&(t.stack||t.message)}`)}),{unexpectedExit:n,disposeStdioListeners:()=>{t.stdout.off("data",s),t.stderr.off("data",i),r.length=0,o.length=0}}}(r);let c;return{exec:async function(t,n){const a=c=(async()=>{try{await c}catch(t){}return async function(t,n){var i;const c=`Run in container: ${t.replace(/\n.*/g,"")}`,a=e.start(c);if(r.stdin.destroyed){e.write("Stdin closed!");const{code:t,signal:n}=await r.exit;return Promise.reject({message:`Shell server terminated (code: ${t}, signal: ${n})`,code:t,signal:n})}r.stdin.write(`( ${t} ); echo -n ${o}$?${o}; echo -n ${o} >&2\n`);const u=s(r.stdout,2),d=s(r.stderr),[l,f]=await u,[p]=await d,m=parseInt(f,10)||0;!1!==(null===(i=n)||void 0===i?void 0:i.logOutput)&&(e.write(l),e.write(p),m&&e.write(`Exit code ${m}`));if(e.stop(c,a),m)return Promise.reject({message:`Command in container failed: ${t}`,code:m,stdout:l,stderr:p});return{stdout:l,stderr:p}}(t,n)})();try{return await Promise.race([a,i.unexpectedExit])}finally{i.disposeStdioListeners(),c===a&&(c=void 0)}}}}},440:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(49),o=n(3),s=n(44),i=n(16);e.dockerComposeShutdown=async function(t,e){const n={exec:await o.getExecFunction(t.cwd,e),cmd:t.dockerCLI,env:t.env,output:e};if(t.rebuild){const{stdout:r,stderr:o}=await i.dockerCLI(n,"rm","-f",t.containerId);e.write("Command output: "+JSON.stringify({stdout:r.toString(),stderr:o.toString()}))}else if(!t.shutdownAction||"stopCompose"===t.shutdownAction){const o=i.dockerExecFunction(n,t.containerId,t.user),c=await s.launch(o,e);if(0===(await r.findSessions(c)).filter(e=>e.sessionId!==t.sessionId).length){const r=["--project-name",t.projectName];t.composeFiles.forEach(t=>r.push("-f",t)),r.push("stop","-t","0"),t.runServices&&t.runServices.length&&r.push(...t.runServices);const{stdout:o,stderr:s}=await i.dockerComposeCLI(n,...r);e.write("Command output: "+JSON.stringify({stdout:o.toString(),stderr:s.toString()}))}}}},441:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(49),o=n(44),s=n(3),i=n(16);e.singleContainerShutdown=async function(t,e){const n={exec:await s.getExecFunction(t.cwd,e),cmd:t.dockerCLI,env:t.env,output:e};if(t.rebuild){const{stdout:r,stderr:o}=await i.dockerCLI(n,"rm","-f",t.containerId);e.write("Command output: "+JSON.stringify({stdout:r.toString(),stderr:o.toString()}))}else if(!t.shutdownAction||"stopContainer"===t.shutdownAction){const s=i.dockerExecFunction(n,t.containerId,t.user),c=await o.launch(s,e);if(0===(await r.findSessions(c)).filter(e=>e.sessionId!==t.sessionId).length){const{stdout:r,stderr:o}=await i.dockerCLI(n,"stop","-t","0",t.containerId);e.write("Command output: "+JSON.stringify({stdout:r.toString(),stderr:o.toString()}))}}}},442:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.nfcall=function(t,...e){return new Promise((n,r)=>t(...e,(t,e)=>t?r(t):n(e)))},e.delay=async function(t){return new Promise(e=>setTimeout(e,t))}},49:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(8),o=n(1),s=n(0),i=n(3);e.terminalEscapeSequences=/(\x9B|\x1B\[)[0-?]*[ -\/]*[@-~]/g,e.createLog=function(t,n,d){const l=Date.now(),f=[];let p=!1;function m(i,c=!1){!function t(e){if(e&&f.push(e),!p&&f.length){p=!0;const e=f.join("");f.length=0,o.appendFile(d,e,n=>{n&&("ENOENT"===n.code?o.mkdir(s.dirname(d),n=>{n?(p=!1,console.error(n)):o.appendFile(d,e,e=>{p=!1,e&&console.error(e),t()})}):(p=!1,console.error(n))),p=!1,t()})}}(`[${(new Date).toISOString()}] [PID ${process.pid}] ${i.replace(e.terminalEscapeSequences,"").replace(/(\r?\n)?$/,r.EOL)}`),t(c?i:n?i.replace(/\r?\n/g,"\r\n").replace(/(\r?\n)?$/,"\r\n"):i.replace(/(\r?\n)?$/,""))}let h=i.LogLevel.Info;return{write(t,e=i.LogLevel.Critical){e>=h&&m(`[${Date.now()-l} ms] ${t}`)},raw(t,e=i.LogLevel.Critical){e>=h&&m(t,!0)},start(t){const e=Date.now();return i.LogLevel.Debug>=h?m(`${u(a,`[${e-l} ms] Start`)}: ${t}`):i.LogLevel.Critical>=h&&m(`[${e-l} ms] Start: ${t}`),e},stop(t,e){if(i.LogLevel.Debug>=h){const n=Date.now();m(`${u(c,`[${n-l} ms] Stop`)} (${n-e} ms): ${t}`)}},setLogLevel(t){h=t},logFilePath:d}};const c="31",a="32";function u(t,e){return e.split("\n").map(e=>`[1m[${t}m${e}[39m[22m`).join("\n")}e.findSessions=async function(t){return(await i.findProcesses(t)).filter(t=>"VSCODE_REMOTE_CONTAINERS_SESSION"in t.env).map(t=>({...t,sessionId:t.env.VSCODE_REMOTE_CONTAINERS_SESSION}))}},6:function(t,e){t.exports=require("util")},8:function(t,e){t.exports=require("os")},80:function(t,e,n){var r=n(0),o=n(1),s=parseInt("0777",8);function i(t,e,n,c){"function"==typeof e?(n=e,e={}):e&&"object"==typeof e||(e={mode:e});var a=e.mode,u=e.fs||o;void 0===a&&(a=s&~process.umask()),c||(c=null);var d=n||function(){};t=r.resolve(t),u.mkdir(t,a,(function(n){if(!n)return d(null,c=c||t);switch(n.code){case"ENOENT":i(r.dirname(t),e,(function(n,r){n?d(n,r):i(t,e,d,r)}));break;default:u.stat(t,(function(t,e){t||!e.isDirectory()?d(n,c):d(null,c)}))}}))}t.exports=i.mkdirp=i.mkdirP=i,i.sync=function t(e,n,i){n&&"object"==typeof n||(n={mode:n});var c=n.mode,a=n.fs||o;void 0===c&&(c=s&~process.umask()),i||(i=null),e=r.resolve(e);try{a.mkdirSync(e,c),i=i||e}catch(o){switch(o.code){case"ENOENT":i=t(r.dirname(e),n,i),t(e,n,i);break;default:var u;try{u=a.statSync(e)}catch(t){throw o}if(!u.isDirectory())throw o}}return i}}}));
//# sourceMappingURL=shutdownMonitorProcess.js.map