"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const semmle_io_1 = require("semmle-io");
const bqrs_parse_1 = require("./bqrs-parse");
async function parse(rs, resultSetHandler) {
    const d = semmle_io_1.StreamDigester.fromChunkIterator(rs);
    const header = await bqrs_parse_1.parseResultSetsHeader(d);
    const stringPool = new bqrs_parse_1.StringPool(await d.read(header.stringPoolSize));
    for (let resultSetIndex = 0; resultSetIndex < header.resultSetCount; resultSetIndex++) {
        await d.readLEB128UInt32(); // Length of result set. Unused.
        const resultSetSchema = await bqrs_parse_1.parseResultSetSchema(d);
        const tupleParser = resultSetHandler(resultSetSchema);
        await bqrs_parse_1.parseTuples(d, resultSetSchema, stringPool, tupleParser);
    }
}
exports.parse = parse;

//# sourceMappingURL=bqrs.js.map
